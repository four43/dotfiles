#!/bin/bash
set -exo pipefail

function process_project_dir() {
    project_path="$1"
    project_name="$(basename "$project_path")"
    
    if $(ls -1 "$project_path" | grep "package.json" 1>&2 2>/dev/null); then
        echo ": $project_name | $project_path"       
    elif $(ls -1 "$project_path" | grep -E "Pipenv|requirements.txt|setup.py" 1>&2 2>/dev/null); then
        echo "üêç: $project_name | $project_path"  
    fi
}
export -f process_project_dir

find ~/projects/ -maxdepth 1 \
    | sort \
    | xargs -n 1 -I % bash -c 'process_project_dir "$@"' _ % \
    | rofi -dmenu
